{% extends "uav-portal/base.html" %}

{% block title %} Complaint Form {% endblock %}

{% block content %}
<div class="container mt-4">
    <h3>Raise New Complaint</h3>
    <form method="post" action="{% url 'complain_submit' %}" enctype="multipart/form-data" class = " border border-primary rounded-4 p-4">
        {% csrf_token %}
        
        <!-- UAV Selection -->
         <div class="row  mb-3">
            <div class="col-md-6">
                <label for="enterName" class="form-label">Pilot Name</label>
                <input type="text" class="form-control" name="pilot_name" placeholder="Enter pilot name" aria-label="First name">
            </div>
            <div class="col-md-6">
                <label for="exampleFormControlInput1" class="form-label">Email address</label>
                <input type="email" class="form-control" id="exampleFormControlInput1" name="email" placeholder="name@example.com">
            </div>
        </div>
        <div class="row  mb-3">
            <div class="col-md-6">
                <label for="exampleFormControlInput1" class="form-label">Certificate number</label>
                <input type="text" class="form-control" placeholder="Enter drone flying certificate number"  name="certificate_number" aria-label="certificate-number">
            </div>
            <div class="col-md-6">
                <label for="exampleFormControlInput1" class="form-label">Desgination</label>
                <input type="text" class="form-control" id="exampleFormControlInput1" name="designation" placeholder="Enter your Designation">
            </div>
        </div>

        <hr>

        <div class="row  mb-3">
            <div class="col-md-4">
                <label for="occurrenceDate" class="form-label">Date of Occurance</label>
                <input type="date" class="form-control" placeholder="Enter drone flying certificate number" name="date_of_occurrence" aria-label="occurance">
            </div>
            <div class="col-md-4">
                <label for="occurrenceTime" class="form-label">Time of Occurance</label>
                <input type="time" class="form-control" name="time_of_occurrence" id="occurrenceTime" placeholder="Enter your Designation">
            </div>
            <div class="col-md-4">
                <label for="fieldSite" class="form-label">Field/Site</label>
                <input type="text" class="form-control" name="field_site" id="fieldSite" placeholder="Enter your Designation">
            </div>
        </div>

        <div class="row  mb-4">
            <div class="col-md-3">
                <label for="eventType" class="form-label">Event Type</label>
                <select class="form-select" id="eventType" name="event_type" required>
                    <option value="accident">Accident</option>
                    <option value="incident">Incident</option>
                </select>
            </div>
            <div class="col-md-3">
                <label for="damageLevel" class="form-label">Damage Level</label>
                <select class="form-select" id="damageLevel" name="damage_level" required>
                    <option value="severe">Severe</option>
                    <option value="moderate">Moderate</option>
                    <option value="moderate">Minor</option>
                    <option value="moderate">None</option>
                </select>
            </div>
            <div class="col-md-3">
                <label for="flightMode" class="form-label">Flight Mode</label>
                <select class="form-select" id="flightMode" name="flight_mode" required>
                    <option value="takeoff">Takeoff</option>
                    <option value="stabilize">Stabilize</option>
                    <option value="manual">Manual</option>
                    <option value="fbwa">FBWA</option>
                    <option value="rtl">RTL</option>
                    <option value="auto">Auto</option>
                </select>
            </div>

            <div class="col-md-3">
                <label for="eventPhase" class="form-label">Event Phase</label>
                <select class="form-select" id="eventPhase" name="event_phase" required>
                    <option value="takeoff">Maintanance</option>
                    <option value="stabilize">Positioning</option>
                    <option value="manual">Startup</option>
                    <option value="fbwa">Chuck Point</option>
                    <option value="rtl">Take Off</option>
                    <option value="auto">Climb</option>
                    <option value="auto">Departure</option>
                    <option value="auto">Cruise</option>
                    <option value="auto">Descent</option>
                    <option value="auto">Rejoin/Approach</option>
                    <option value="auto">Final Phase</option>
                    <option value="auto">Landing/Recovery </option>
                </select>
            </div>
        </div>

        <div class="row mb-3">
            <div class="col-md-3">
                <label for="uavSelect" class="form-label">UAV Type</label>
                <select class="form-select" id="uavSelect" name="uav_type" required>
                    <option value="">Select a UAV</option> 
                    <option value="fixedWing">Fixed Wing</option> 
                </select>
            </div>
            <div class="col-md-3">
                <label for="tailNumber" class="form-label">Tail Number</label>
                <input type="text" class="form-control" id="tailNumber" name="tail_number" placeholder="Enter drone tail number">
            </div>
            <div class="col-md-3">
                <label for="gcsType" class="form-label">GCS Type</label>
                <input type="text" class="form-control" name="gcs_type" id="gcsType" placeholder="Enter GCS type">
            </div>
            <div class="col-md-3">
                <label for="gcsNumber" class="form-label">GCS Number</label>
                <input type="text" class="form-control" name="gcs_number" id="gcsNumber" placeholder="Enter GCS type">
            </div>
        </div>


        <div class="row mb-3">
            <div class="col-md-3">
                <label for="uavWeight" class="form-label">UAV Weight</label>
                <input type="number" id="uavWeight" name="uav_weight" class="form-control" name="uavWeight" required>
            </div>

            <!-- Meteorology started -->

            <div class="col-md-3">
                <label for="wind" class="form-label">Wind</label>
                <input type="number" class="form-control" name="wind" id="wind" placeholder="Enter wind speed">
            </div>
            <div class="col-md-3">
                <label for="temperature" class="form-label">Temperature</label>
                <input type="number" class="form-control" name="temperature" id="temperature" placeholder="Enter temperature">
            </div>
            <div class="col-md-3">
                <label for="pressure" class="form-label">Pressure QNH</label>
                <input type="text" class="form-control" name="pressure" id="pressure" placeholder="Enter QNH Pressure">
            </div>
        </div>

        <!-- Meteorology checkbox -->
        <div class="row mb-3">
            <div>
                <label class="form-label"><strong>Meteorology</strong></label>
            </div>

            <div class="d-flex flex-wrap gap-3">
                <div class="form-check">
                    <input class="form-check-input" name="rain" type="checkbox" id="rain">
                    <label class="form-check-label" for="rain">Rain</label>
                </div>

                <div class="form-check">
                    <input class="form-check-input" name="icing" type="checkbox" id="icing">
                    <label class="form-check-label" for="icing">Icing</label>
                </div>

                <div class="form-check">
                    <input class="form-check-input" name="snow" type="checkbox" id="snow">
                    <label class="form-check-label" for="snow">Snow</label>
                </div>

                <div class="form-check">
                    <input class="form-check-input" name="turbulance" type="checkbox" id="turbulence">
                    <label class="form-check-label" for="turbulence">Turbulence</label>
                </div>

                <div class="form-check">
                    <input class="form-check-input" name="windshear" type="checkbox" id="wind">
                    <label class="form-check-label" for="wind">Wind Shear</label>
                </div>
            </div>
        </div>


        <!-- Media Files upload -->
        <div class="mb-3">
            <label class="form-label">Upload Video (Optional)</label>
            <input type="file" class="form-control" name="video" accept=".mp4,.avi,.mov">
        </div>

        <div class="mb-3">
            <label class="form-label">Upload Photos (Max 3)</label>
            <input type="file" class="form-control" name="photo1" accept=".jpg,.jpeg,.png">
            <input type="file" class="form-control mt-2" name="photo2" accept=".jpg,.jpeg,.png">
            <input type="file" class="form-control mt-2" name="photo3" accept=".jpg,.jpeg,.png">
        </div>

        <div class="mb-3">
            <label class="form-label">Upload Log File (Required)</label>
            <input type="file" class="form-control" name="log_file" accept=".txt,.log,.csv" required>
        </div>



        <div class="mb-3">
    <label class="form-label">Event Description</label>
    <textarea class="form-control" name="event_description" rows="3"></textarea>
</div>

<div class="mb-3">
    <label class="form-label">Initial Actions Taken</label>
    <textarea class="form-control" name="initial_actions_taken" rows="3"></textarea>
</div>

<div class="mb-3">
    <label class="form-label">Remarks (Optional)</label>
    <textarea class="form-control" name="remarks" rows="2"></textarea>
</div>

<div class="mb-3">
    <label class="form-label">Organization</label>
    <input type="text" class="form-control" name="organization">
</div>


        <!-- Submit -->
        <div class="mb-3">
            <button type="submit" class="btn btn-primary">Submit Complaint</button>
        </div>
    </form>
</div>

{% endblock %}

{% block extra_js %}
<script>
    // Optional: show selected files
    const fileInput = document.getElementById('fileInput');
    if(fileInput){
        fileInput.addEventListener('change', function() {
            const fileNames = Array.from(this.files).map(f => f.name).join(', ');
            console.log("Selected files:", fileNames); // or show somewhere on page
        });
    }
</script>
{% endblock %}
